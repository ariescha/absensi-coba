<script src="html5-qrcode.min.js"></script>
<div style="width: 500px" id="qr-reader"></div>
<form action="getlocation.php">
	<input type="text" id="syalala" name="syalala">
	<input type="text" id="papapa" name="papapa">
	<input type="text" id="selisih" name="selisih">
	<button type="submit">Submit</button>
</form>



<script type="text/javascript">
	function deg2rad(deg) {
		return deg * (Math.PI/180)
	}
	function onScanSuccess(decodedText, decodedResult) {
    	console.log(`Code scanned = ${decodedText}`, decodedResult);
		navigator.geolocation.getCurrentPosition(function(position) {
		let lat1 = position.coords.latitude;
		let long1 = position.coords.longitude;
		let str = decodedText;
		str = str.split(";");
		console.log(str[1]);
		document.getElementById('syalala').value = str[0];
		document.getElementById('papapa').value = str[1];
		var R = 6371; // Radius of the earth in km
		var dLat = deg2rad(str[0]-lat1);  // deg2rad below
		var dLong = deg2rad(str[1]-long1); 

		var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(str[0])) * Math.sin(dLong/2) * Math.sin(dLong/2); 

		var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
		var d = R * c; // Dis	tance in km
		document.getElementById('selisih').value = d;
  
		html5QrcodeScanner.clear();
		});
		// var lat1 = -6.2928053;
		// var long1 =106.8796755;
		
	}
	var html5QrcodeScanner = new Html5QrcodeScanner(
		"qr-reader", { fps: 10, qrbox: 250 });
	html5QrcodeScanner.render(onScanSuccess);
</script>

